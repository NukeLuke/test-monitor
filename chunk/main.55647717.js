(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"M/Zy":function(e,t,n){},QOxo:function(e,t,n){e.exports={buttons:"App__buttons--2cZLQ"}},Vtdi:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),c=n("i8i4"),o=n.n(c),i=n("Wgwc"),l=n.n(i),d=(n("pHGr"),n("kPgG"),n("M/Zy"),n("yXPU")),u=n.n(d),s=n("J4zp"),m=n.n(s),v=n("o0o1"),b=n.n(v),f=n("QOxo"),p=n.n(f),g=function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null),c=Object(r.useRef)(null),o=Object(r.useRef)(null),i=Object(r.useRef)(null),l=Object(r.useRef)({timer:0,recordedBlobs:[]}),d=Object(r.useState)(0),s=m()(d,2),v=s[0],f=s[1],g=Object(r.useState)(null),h=m()(g,2),w=h[0],E=h[1],y=Object(r.useState)(0),k=m()(y,2),C=k[0],R=k[1],j=function(){clearInterval(l.current.timer),f(0)},O=Object(r.useCallback)((function(){var e=l.current.mediaRecorder;e&&"inactive"===e.state&&(console.log("MediaRecorder started",e),l.current.recordedBlobs=[],e.ondataavailable=function(e){l.current.recordedBlobs.push(e.data)},j(),l.current.timer=window.setInterval((function(){f((function(e){return e+1}))}),1e3),e.start(1e3))}),[]),x=Object(r.useCallback)((function(){var e=l.current,t=e.mediaRecorder,n=e.recordedBlobs;t&&"recording"===t.state&&(console.log("MediaRecorder stop"),j(),t.stop(),console.log("Recorded Blobs: ",n))}),[]),B=function(){var e=u()(b.a.mark((function e(){var t,n,r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=l.current.recordedBlobs).length&&(n=new Blob(t,{type:"video/webm;codecs=vp9"}),r=window.URL.createObjectURL(n),(a=document.createElement("a")).style.display="none",a.href=r,a.download="bridge-plus.webm",document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(r)}),100));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){}),[]);var L=function(){var e=u()(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia();case 4:t=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),"浏览器不支持webrtc"+e.t0;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"Container"},a.a.createElement("div",{className:p.a.videos},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{className:"VideoCard",title:"录制窗口"},a.a.createElement("video",{width:500,height:400,ref:c,autoPlay:!0,controls:!0}),a.a.createElement("div",null,"时间: ",v)),a.a.createElement("div",{className:"VideoCard",title:"录制内容"},a.a.createElement("video",{width:500,height:400,ref:o,autoPlay:!0,controls:!0})),a.a.createElement("div",{className:"VideoCard",title:"截取桌面"},a.a.createElement("video",{width:500,height:400,ref:i,autoPlay:!0,controls:!0}))),a.a.createElement("div",{className:p.a.buttons},a.a.createElement("button",{onClick:function(){var e={mimeType:"video/webm;codecs=vp9",BitsPerSecond:100};navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){c.current&&(c.current.srcObject=t,l.current.mediaRecorder=new MediaRecorder(t,e),console.log("Created MediaRecorder",l.current.mediaRecorder))}))}},"开启摄像头")),a.a.createElement("div",{className:p.a.buttons},a.a.createElement("button",{onClick:O},"开始录制"),a.a.createElement("button",{ghost:!0,onClick:x},"结束录制"),a.a.createElement("button",{onClick:function(){var e=l.current.recordedBlobs;if(e.length){var t=new Blob(e,{type:"video/webm"});o.current&&(o.current.src=window.URL.createObjectURL(t))}}},"播放")),a.a.createElement("div",{className:p.a.buttons},a.a.createElement("button",{onClick:function(){t.current.getContext("2d").drawImage(c.current,0,0,500,400);var e=t.current.toDataURL("image/jpeg",.9),n=document.createElement("div"),r=new Image;r.src=e,n.appendChild(r),E(e);var a=parseInt(e.length-e.length/8*2);console.log((a/1024).toFixed(2))}},"截取摄像头"),a.a.createElement("button",{ghost:!0,onClick:function(){L().then((function(e){i.current.srcObject=e,setTimeout((function(){n.current.getContext("2d").drawImage(i.current,0,0,500,400);var e=n.current.toDataURL("image/jpeg",.9),t=document.createElement("div"),r=new Image;r.src=e,t.appendChild(r),R(e)}),300)}))}},"截取桌面")),a.a.createElement("div",{className:p.a.buttons},a.a.createElement("button",{ghost:!0,onClick:B},"视频下载(需录制视频)"),a.a.createElement("button",{ghost:!0,onClick:function(){var e=document.createElement("a");e.style.display="none",e.href=w,e.download="camera.jpeg",document.body.appendChild(e),e.click(),setTimeout((function(){document.body.removeChild(e)}),100)}},"摄像头截图下载"),a.a.createElement("button",{ghost:!0,onClick:function(){var e=document.createElement("a");e.style.display="none",e.href=C,e.download="desktop.jpeg",document.body.appendChild(e),e.click(),setTimeout((function(){document.body.removeChild(e)}),100)}},"桌面截图下载")),a.a.createElement("canvas",{ref:t,width:500,height:400}),a.a.createElement("canvas",{ref:n,width:500,height:400})))};l.a.locale("zh-cn");var h=function(){return a.a.createElement(g,null)};o.a.render(a.a.createElement(h,null),document.getElementById("app")),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("service-worker.js").then((function(e){console.log("SW registered: ",e)})).catch((function(e){console.log("SW registration failed: ",e)}))}))},kPgG:function(e,t,n){}},[["Vtdi",2,0,3]]]);